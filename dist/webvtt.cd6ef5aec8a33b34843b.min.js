(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{270:function(e,t,n){"use strict";n.r(t);var a=function(e,t){var n=/[\u0020\t\f]/,a=/[^\u0020\t\f]/,i=(e=e,0),s=function(e){t(e,i+1)};function r(t){for(;null!=e[i]&&t.test(e[i]);)i++}function l(t){for(var n="";null!=e[i]&&t.test(e[i]);)n+=e[i],i++;return n}function o(){var t,n,a,r,o="minutes";if(null!=e[i])if(/\d/.test(e[i]))if(((t=l(/\d/)).length>2||parseInt(t,10)>59)&&(o="hours"),":"==e[i])if(i++,2==(n=l(/\d/)).length){if("hours"==o||":"==e[i]){if(":"!=e[i])return void s("No seconds found or minutes is greater than 59.");if(i++,2!=(a=l(/\d/)).length)return void s("Must be exactly two digits.")}else a=n,n=t,t="0";if("."==e[i])if(i++,3==(r=l(/\d/)).length)if(parseInt(n,10)>59)s("You cannot have more than 59 minutes.");else{if(!(parseInt(a,10)>59))return 60*parseInt(t,10)*60+60*parseInt(n,10)+parseInt(a,10)+parseInt(r,10)/1e3;s("You cannot have more than 59 seconds.")}else s("Milliseconds must be given in three digits.");else s('No decimal separator (".") found.')}else s("Must be exactly two digits.");else s("No time unit separator found.");else s("Timestamp must start with a character in the range 0-9.");else s("No timestamp found.")}this.parse=function(t,l){if(r(n),t.startTime=o(),null!=t.startTime)if(t.startTime<l&&s("Start timestamp is not greater than or equal to start timestamp of previous cue."),a.test(e[i])&&s("Timestamp not separated from '--\x3e' by whitespace."),r(n),"-"==e[i])if(i++,"-"==e[i])if(i++,">"==e[i]){if(i++,a.test(e[i])&&s("'--\x3e' not separated from timestamp by whitespace."),r(n),t.endTime=o(),null!=t.endTime)return t.endTime<=t.startTime&&s("End timestamp is not greater than start timestamp."),a.test(e[i])&&!1,r(n),function(e,t){for(var a=e.split(n),i=[],r=0;r<a.length;r++)if(""!=a[r]){var l=a[r].indexOf(":"),o=a[r].slice(0,l);if(value=a[r].slice(l+1),-1!=i.indexOf(o)&&s("Duplicate setting."),i.push(o),""==value)return void s("No value for setting defined.");if("vertical"==o){if("rl"!=value&&"lr"!=value){s("Writing direction can only be set to 'rl' or 'rl'.");continue}t.direction=value}else if("line"==o){if(!/\d/.test(value)){s("Line position takes a number or percentage.");continue}if(-1!=value.indexOf("-",1)){s("Line position can only have '-' at the start.");continue}if(-1!=value.indexOf("%")&&value.indexOf("%")!=value.length-1){s("Line position can only have '%' at the end.");continue}if("-"==value[0]&&"%"==value[value.length-1]){s("Line position cannot be a negative percentage.");continue}if("%"==value[value.length-1]){if(parseInt(value,10)>100){s("Line position cannot be >100%.");continue}t.snapToLines=!1}t.linePosition=parseInt(value,10)}else if("position"==o){if("%"!=value[value.length-1]){s("Text position must be a percentage.");continue}if(parseInt(value,10)>100){s("Size cannot be >100%.");continue}t.textPosition=parseInt(value,10)}else if("size"==o){if("%"!=value[value.length-1]){s("Size must be a percentage.");continue}if(parseInt(value,10)>100){s("Size cannot be >100%.");continue}t.size=parseInt(value,10)}else if("align"==o){var u=["start","middle","end","left","right"];if(-1==u.indexOf(value)){s("Alignment can only be set to one of "+u.join(", ")+".");continue}t.alignment=value}else s("Invalid setting.")}}(e.substring(i),t),!0}else s("No valid timestamp separator found.");else s("No valid timestamp separator found.");else s("No valid timestamp separator found.")},this.parseTimestamp=function(){var t=o();if(null==e[i])return t;s("Timestamp must not have trailing characters.")}},i=function(e,t,n){e=e;var i=0,s=function(e){"metadata"!=n&&t(e,i+1)};function r(){for(var t="data",n="",a="",r=[];null!=e[i-1]||0==i;){var l=e[i];if("data"==t)if("&"==l)a=l,t="escape";else if("<"==l&&""==n)t="tag";else{if("<"==l||null==l)return["text",n];n+=l}else if("escape"==t)if("&"==l)s("Incorrect escape."),n+=a,a=l;else if(/[abglmnsprt]/.test(l))a+=l;else if(";"==l)"&amp"==a?n+="&":"&lt"==a?n+="<":"&gt"==a?n+=">":"&lrm"==a?n+="‎":"&rlm"==a?n+="‏":"&nbsp"==a?n+=" ":(s("Incorrect escape."),n+=a+";"),t="data";else{if("<"==l||null==l)return s("Incorrect escape."),["text",n+=a];s("Incorrect escape."),n+=a+l,t="data"}else if("tag"==t)if("\t"==l||"\n"==l||"\f"==l||" "==l)t="start tag annotation";else if("."==l)t="start tag class";else if("/"==l)t="end tag";else if(/\d/.test(l))n=l,t="timestamp tag";else{if(">"==l||null==l)return">"==l&&i++,["start tag","",[],""];n=l,t="start tag"}else if("start tag"==t)if("\t"==l||"\f"==l||" "==l)t="start tag annotation";else if("\n"==l)a=l,t="start tag annotation";else if("."==l)t="start tag class";else{if(">"==l||null==l)return">"==l&&i++,["start tag",n,[],""];n+=l}else if("start tag class"==t)if("\t"==l||"\f"==l||" "==l)r.push(a),a="",t="start tag annotation";else if("\n"==l)r.push(a),a=l,t="start tag annotation";else if("."==l)r.push(a),a="";else{if(">"==l||null==l)return">"==l&&i++,r.push(a),["start tag",n,r,""];a+=l}else if("start tag annotation"==t){if(">"==l||null==l)return">"==l&&i++,["start tag",n,r,a=a.split(/[\u0020\t\f\r\n]+/).filter((function(e){if(e)return!0})).join(" ")];a+=l}else if("end tag"==t){if(">"==l||null==l)return">"==l&&i++,["end tag",n];n+=l}else if("timestamp tag"==t){if(">"==l||null==l)return">"==l&&i++,["timestamp",n];n+=l}else s("Never happens.");i++}}this.parse=function(t,l){var o={children:[]},u=o,f=[];function p(e){u.children.push({type:"object",name:e[1],classes:e[2],children:[],parent:u}),u=u.children[u.children.length-1]}function c(e){for(var t=u;t;){if(t.name==e)return!0;t=t.parent}}for(;null!=e[i];){var m=r();if("text"==m[0])u.children.push({type:"text",value:m[1],parent:u});else if("start tag"==m[0]){"chapters"==n&&s("Start tags not allowed in chapter title text.");var d=m[1];"v"!=d&&"lang"!=d&&""!=m[3]&&s("Only <v> and <lang> can have an annotation."),"c"==d||"i"==d||"b"==d||"u"==d||"ruby"==d||"rt"==d&&"ruby"==u.name?p(m):"v"==d?(c("v")&&s("<v> cannot be nested inside itself."),p(m),u.value=m[3],m[3]||s("<v> requires an annotation.")):"lang"==d?(p(m),u.value=m[3]):s("Incorrect start tag.")}else if("end tag"==m[0])"chapters"==n&&s("End tags not allowed in chapter title text."),m[1]==u.name?u=u.parent:"ruby"==m[1]&&"rt"==u.name?u=u.parent.parent:s("Incorrect end tag.");else if("timestamp"==m[0]){"chapters"==n&&s("Timestamp not allowed in chapter title text.");var v=new a(m[1],s).parseTimestamp();null!=v&&((v<=t||v>=l)&&s("Timestamp must be between start timestamp and end timestamp."),f.length>0&&f[f.length-1]>=v&&s("Timestamp must be greater than any previous timestamp."),u.children.push({type:"timestamp",value:v,parent:u}),f.push(v))}}for(;u.parent;)"v"!=u.name&&s("Required end tag missing."),u=u.parent;return o}};t.default=function(){this.parse=function(e,t){var n=Date.now(),s=0,r=e.split(/\r\n|\r|\n/),l=!1,o=[],u=[];function f(e,t){u.push({message:e,line:s+1,col:t})}var p=r[s],c=p.length,m=0,d="WEBVTT".length;for("\ufeff"===p[0]&&(m=1,d+=1),(c<d||p.indexOf("WEBVTT")!==0+m||c>d&&" "!==p[d]&&"\t"!==p[d])&&f('No valid signature. (File needs to start with "WEBVTT".)'),s++;""!=r[s]&&null!=r[s];){if(f("No blank line after the signature."),-1!=r[s].indexOf("--\x3e")){l=!0;break}s++}for(;null!=r[s];){for(var v;!l&&""==r[s];)s++;if(!l&&null==r[s])break;v={id:"",startTime:0,endTime:0,pauseOnExit:!1,direction:"horizontal",snapToLines:!0,linePosition:"auto",textPosition:50,size:100,alignment:"middle",text:"",tree:null};var g=!0;if(-1==r[s].indexOf("--\x3e")){if(v.id=r[s],/^NOTE($|[ \t])/.test(v.id)){for(s++;""!=r[s]&&null!=r[s];)-1!=r[s].indexOf("--\x3e")&&f("Cannot have timestamp in a comment."),s++;continue}if(""==r[++s]||null==r[s]){f("Cue identifier cannot be standalone.");continue}-1==r[s].indexOf("--\x3e")&&(g=!1,f("Cue identifier needs to be followed by timestamp."))}l=!1;var h=new a(r[s],f),x=0;if(o.length>0&&(x=o[o.length-1].startTime),!g||h.parse(v,x)){for(s++;""!=r[s]&&null!=r[s];){if(-1!=r[s].indexOf("--\x3e")){f("Blank line missing before cue."),l=!0;break}""!=v.text&&(v.text+="\n"),v.text+=r[s],s++}var T=new i(v.text,f,t);v.tree=T.parse(v.startTime,v.endTime),o.push(v)}else for(v=null,s++;""!=r[s]&&null!=r[s];){if(-1!=r[s].indexOf("--\x3e")){l=!0;break}s++}}return o.sort((function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:e.endTime>t.endTime?-1:e.endTime<t.endTime?1:0})),{cues:o,errors:u,time:Date.now()-n}}}}}]);